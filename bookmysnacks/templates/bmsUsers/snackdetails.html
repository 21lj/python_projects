{% extends 'base1.html' %}
{% load static %}

{% block title %}Snack - {{ snack.snack_name }}{% endblock %}

{% block extra_head %}
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <link rel="stylesheet" href="{% static 'css/snackDetails.css' %}" />
    <link rel="stylesheet" href="{% static 'css/userhomcss.css' %}" />
    <link rel="stylesheet" href="{% static 'css/updtCss.css' %}" />
    
{% endblock %}

{% block content %}
<div class="sdq-viewS-container">
    <div class="sdq-viewS-image-container">
        <img alt="{{ snack.snack_name }}" src="{{ snack.image.url }}" />
    </div>
    <div class="sdq-viewS-details">
        <h1>{{ snack.snack_name }}</h1>

        <form method="POST" id="snackForm">
            {% csrf_token %}
            <div class="sdq-viewS-quantity">
                <button type="button" onclick="min()" class="sdq-quantity-btn">-</button>
                <input id="qty" class="sdq-quantity-value" name="quantity" type="number" min="1" max="10" value="1" readonly />
                <button type="button" onclick="add()" class="sdq-quantity-btn">+</button>
            </div>

            <div class="sdq-viewS-nutrition">
                {{ snack.description }}
            </div>

            <div class="sdq-viewS-total">
                ₹ {{ snack.price }}
                {% if snack.availability %}
                    <div class="sdq-viewS-buttons">
                        <button onclick="setAction('buy')" type="submit" class="sdq-viewS-add-to-cart">Buy</button>
                        <button onclick="setAction('add')" type="submit" class="sdq-viewS-add-to-cart">Add to Cart</button>
                    </div>
                {% else %}
                    <p class="text-warning">At the moment, out of stock</p>
                {% endif %}
            </div>
        </form>
    </div>
</div>

<div class="mt-3">
    <h2>Similar Snacks</h2>
    <ul class="sdq-snack-list">
        {% for i in simlarSnacks %}
            <li class="sdq-snack-card">
                <a href="{% url 'bmsUsers:getSnacks' i.id %}">
                    <img src="{{ i.image.url }}" alt="{{ i.snack_name }}" class="sdq-snack-image" />
                    <div class="sdq-snack-info">
                        <h4>{{ i.snack_name }}</h4>
                        <p>₹ {{ i.price }}</p>
                    </div>
                </a>
            </li>
        {% endfor %}
    </ul>
</div>

{% include './footer.html' %}
{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/quantity.js' %}"></script>
<script>
    function setAction(option) {
        const form = document.getElementById('snackForm');
        if (option === 'add') {
            form.action = "{% url 'bmsUsers:add2cart' snack.id %}";
        } else if (option === 'buy') {
            form.action = "{% url 'bmsUsers:buyNow' snack.id %}";
        }
    }
</script>
{% endblock %}
